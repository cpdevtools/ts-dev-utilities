name: Scheduled Cleanup

on:
  schedule:
    - cron: '0 2 * * *'  # Daily at 2 AM UTC
  workflow_dispatch:
    inputs:
      days_old:
        description: 'Delete builds older than X days'
        type: number
        default: 14
      dry_run:
        description: 'Dry run (do not delete, just show what would be deleted)'
        type: boolean
        default: true

jobs:
  cleanup:
    uses: cpdevtools/git-flow/.github/workflows/cleanup-old-builds.yml@main
    with:
      days_old: ${{ github.event_name == 'workflow_dispatch' && inputs.days_old || 14 }}
      dry_run: ${{ github.event_name == 'workflow_dispatch' && inputs.dry_run || false }}
    secrets:
      token: ${{ secrets.GITHUB_TOKEN }}
